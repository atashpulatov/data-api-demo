<!-- <%@ page language="Java" import="com.microstrategy.auth.sessionmgr.SessionManager" %>
<%@ page language="Java" import="com.microstrategy.auth.rest.ParamNames" %>
<%
  SessionManager sessionManager = (SessionManager)session.getAttribute(ParamNames.SESSION_MANAGER);
  String authToken = sessionManager.getAccessToken();
%> -->
<!DOCTYPE html>
<html lang="en">

<!-- NOTE: Only for testing purposes. This is a copy of the jsp file located in MicroStrategyLibrary/auth -->

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>MicroStrategy - Authenticating...</title>
</head>

<body>
  <noscript>You need to enable JavaScript to login.</noscript>
  <script>var m={type:"auth-token",payload:"<%=authToken%>"};function messageParent(){var e=Office;function t(){e&&e.context&&e.context.ui&&e.context.ui.messageParent&&e.context.ui.messageParent(JSON.stringify(m))}e?(e.initialize=t,e.onReady().then(t)):setTimeout(messageParent,1e3)}parent&&parent!==window&&parent.postMessage(m),opener&&opener!==window&&opener.postMessage(m),document.addEventListener("DOMContentLoaded",messageParent);</script>
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</body>

</html>
