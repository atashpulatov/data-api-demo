job 'stage-2-e2e-general-windows-desktop-job' do	
  description 'run browser based e2e python test for excel plugin, on mac'	

  configure_common_items{}	

  properties do
    inject do
      properties_content "MSYS=winsymlinks:nativestrict
        PATH=/usr/local/.rbenv/shims:/usr/local/ruby-install/bin:/usr/local/rbenv/libexec:/tools/msys/20160205-3/cmd:/tools/Sysinternals:/Users/vagrant/bin:/Users/vagrant/.rbenv/versions/2.2.4/bin:/cmd:/usr/local/bin:/mingw64/bin:/usr/bin:/Windows/system32:/Windows:/Windows/System32/Wbem:/Windows/System32/WindowsPowerShell/v1.0:/usr/bin/site_perl:/usr/bin/vendor_perl:/usr/bin/core_perl:/c/Program\ Files/Amazon/AWSCLI"
    end
    
    parameters do	
      upstream_parameter do	
        name 'TEST_TYPE'	
        description 'the version of the application to deploy and test'	
      end	

    end	
  end	

  scm do	
    git do	
    end	
  end	

  assigned_node_string 'excel-windows-mock-node'	

builders do	
    bash do	
      script '#!/usr/bin/env bash	
set +xe	
export PATH=/usr/local/sbin:/usr/local/bin:$PATH
export WORKSPACE_SETTING=windows_test

source .ecosystem	
export HATS=pipeline:$HATS	

rake py_e2e_test_win[$TEST_TYPE]
'	
    end	
  end	
end 
