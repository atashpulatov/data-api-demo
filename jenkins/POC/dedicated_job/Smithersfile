job 'stage-2-e2e-dedicated-job' do
  description 'run desktop based e2e python test for excel plugin, on windows'

 configure_common_items{}

     parameters do
      upstream_parameter do
        upstream_job_name 'stage-1-dev'
        name 'APPLICATION_VERSION'
        description 'the version of the application to deploy and test'
      end

            upstream_parameter do
        upstream_job_name 'stage-1-dev'
        name 'TEST_TYPE'
        description 'the version of the application to deploy and test'
      end
    end

    

  scm do
    git do
    end
  end

  assigned_node_string 'mstr-office-test'

builders do

   parameterized_builder do
    job_names %w{
      mstr-office-.-#{Environment.branch_name}-.-stage-2-e2e-general-job
    }
    parameters "APPLICATION_VERSION=1 TEST_TYPE=yurii"
    block_and_sync_status true
   end

    bash do
      script '#!/usr/bin/env bash
set +xe

export PATH=/usr/local/sbin:/usr/local/bin:$PATH
export TERM_PROGRAM=iTerm.app
export WORKSPACE_SETTING=mac_test

source .ecosystem
export HATS=pipeline:$HATS

rake copy_results rake yurii_test[$APPLICATION_VERSION, $TEST_TYPE]
'
    end
  end

  publishers do
    html do
       report_name 'Windows Desktop e2e Python Test Report'
       report_directory_path "tests/results/$APPLICATION_VERSION/$TEST_TYPE"
       index_file_name 'index.html'
    end
  end

end