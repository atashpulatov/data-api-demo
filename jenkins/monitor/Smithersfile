job 'stage-0-monitor' do
  description 'monitor String DB change'

  configure_common_items{}

  assigned_node_string 'rhel8_vra_monitor'

  triggers do
    url_trigger do
      set_to_every_minute
      url "https://nexus.internal.microstrategy.com/content/repositories/releases/com/microstrategy/next/ProductStrings/MSTR_OFFICE/"
    end
  end

  builders do
    bash do
      script '#!/usr/bin/env bash
set +xe

export PATH=/usr/local/sbin:/usr/local/bin:$PATH
export ENABLE_BASELINE_WORKSPACE_CHEF=false
export WORKSPACE_SETTING=fake
source .ecosystem
rake pre_pipeline

rake update_strings

rake post_pipeline
'
    end
  end

  publishers do
    # junit do
    # end
    #
    # cobertura do
    # end
    #
    # cucumber do
    #   file_include_pattern 'prepush_test.json'
    # end
    #
    # html do
    #   report_name 'Vagrant Logs'
    #   report_directory_path "deploy/vagrant/esxi/dev/logs"
    #   index_file_name 'index.html'
    # end

    #parameterized_trigger do
    #  job_short_names %w{
    #    stage-2-regression-test
    #  }
    #end
  end

end


